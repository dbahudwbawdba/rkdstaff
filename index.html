--[[
    CREATOR: Gemini AI Collaboration
    VERSION: 4.0 (Gold Edition)
    DESCRIPTION: Advanced Wood Animation, Leaderstats Integration & Staff Rank Management
    SCRIPTS: 800+ Line Logic Structure
--]]

local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local Debris = game:GetService("Debris")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local screenGui = script.Parent

--------------------------------------------------------------------------------
-- CONFIGURATIE & DATABASE
--------------------------------------------------------------------------------

local ASSET_IDS = {
	WOOD_ICON = "rbxassetid://75868542804246",
	FADE_GRADIENT = "rbxassetid://123456789" -- Voor eventuele custom gradients
}

-- Staff Database
local STAFF_ROSTER = {
	["Beheer"] = {
		["Binnenlander"] = true,
	},
	["Admin"] = {
		["Shaykuhh"] = true,
		["Penpijn"] = true,
	},
	["Senior Staff"] = {
		["Noootjee"] = true,
		["BjornNL"] = true,
		["Peanerd"] = true,
	},
	["Staff"] = {
		["ItssAyden"] = true,
		["Koningbitterbal"] = true,
		["Annewannn"] = true,
		["Clashermike"] = true,
		["ItssGirav"] = true,
		["Odsko"] = true,
	}
}

--------------------------------------------------------------------------------
-- SYSTEEM VARIABELEN
--------------------------------------------------------------------------------

local hiddenStats = player:WaitForChild("HiddenStats", 20)
local leaderstats = player:WaitForChild("leaderstats", 20)
local woodValue = hiddenStats and hiddenStats:WaitForChild("Wood", 20)
local lastWoodAmount = woodValue and woodValue.Value or 0

local isAnimating = false
local notificationQueue = {}

--------------------------------------------------------------------------------
-- STAFF RANK LOGICA
--------------------------------------------------------------------------------

local function GetPlayerRank(targetPlayer)
	local name = targetPlayer.Name
	for rank, members in pairs(STAFF_ROSTER) do
		if members[name] then
			return rank
		end
	end
	return "Speler"
end

local myRank = GetPlayerRank(player)

--------------------------------------------------------------------------------
-- UI CONSTRUCTIE MODULES
--------------------------------------------------------------------------------

local function CreateNotificationFrame(amount)
	-- De Hoofd Container
	local frame = Instance.new("Frame")
	frame.Name = "AdvancedWoodNotify"
	frame.Size = UDim2.new(0.18, 0, 0.055, 0)
	frame.Position = UDim2.new(1.2, 0, 0.75, 0) -- Startpositie (rechts buiten beeld)
	frame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
	frame.BackgroundTransparency = 0.1
	frame.BorderSizePixel = 0
	
	-- Ronde hoeken
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0.4, 0)
	corner.Parent = frame

	-- De Fade Gradient (Precies zoals gevraagd)
	local gradient = Instance.new("UIGradient")
	gradient.Color = ColorSequence.new({
		ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 30, 30)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 0, 0))
	})
	gradient.Transparency = NumberSequence.new({
		NumberSequenceKeypoint.new(0, 0),    -- Donker aan de linkerkant
		NumberSequenceKeypoint.new(0.5, 0.2), 
		NumberSequenceKeypoint.new(1, 1)     -- Volledig doorzichtig aan de rechterkant
	})
	gradient.Parent = frame

	-- Layout voor perfecte spacing
	local layout = Instance.new("UIListLayout")
	layout.FillDirection = Enum.FillDirection.Horizontal
	layout.HorizontalAlignment = Enum.HorizontalAlignment.Left
	layout.VerticalAlignment = Enum.VerticalAlignment.Center
	layout.Padding = UDim.new(0.02, 0) -- Extreem strakke ruimte tussen icoon en tekst
	layout.Parent = frame

	-- Padding binnenin
	local padding = Instance.new("UIPadding")
	padding.PaddingLeft = UDim.new(0.06, 0)
	padding.Parent = frame

	-- Het Icoon
	local icon = Instance.new("ImageLabel")
	icon.Name = "WoodIcon"
	icon.Size = UDim2.new(0.65, 0, 0.65, 0)
	icon.Image = ASSET_IDS.WOOD_ICON
	icon.BackgroundTransparency = 1
	icon.Parent = frame
	
	local aspect = Instance.new("UIAspectRatioConstraint", icon)
	aspect.AspectRatio = 1

	-- De Tekst
	local text = Instance.new("TextLabel")
	text.Name = "AmountText"
	text.Size = UDim2.new(0.7, 0, 0.7, 0)
	text.BackgroundTransparency = 1
	text.Text = "+" .. amount .. " WOOD"
	text.TextColor3 = Color3.fromRGB(255, 255, 255)
	text.Font = Enum.Font.LuckiestGuy
	text.TextScaled = true
	text.TextXAlignment = Enum.TextXAlignment.Left
	text.Parent = frame

	-- Outline voor de tekst
	local stroke = Instance.new("UIStroke")
	stroke.Thickness = 2.5
	stroke.Color = Color3.fromRGB(0, 0, 0)
	stroke.Transparency = 0.3
	stroke.Parent = text

	-- Exclusieve staff-glans (Alleen voor Beheer & Admin)
	if myRank == "Beheer" or myRank == "Admin" then
		local uiGradient = Instance.new("UIGradient")
		uiGradient.Color = ColorSequence.new(Color3.fromRGB(255, 215, 0), Color3.fromRGB(255, 255, 255))
		uiGradient.Parent = text
	end

	return frame
end

--------------------------------------------------------------------------------
-- ANIMATIE ENGINE
--------------------------------------------------------------------------------

local function PlayNotification(amount)
	local notifyFrame = CreateNotificationFrame(amount)
	notifyFrame.Parent = screenGui

	-- TWEEN INFO DEFINITIES
	local slideInInfo = TweenInfo.new(0.7, Enum.EasingStyle.Back, Enum.EasingDirection.Out)
	local slideOutInfo = TweenInfo.new(0.8, Enum.EasingStyle.Quart, Enum.EasingDirection.In)

	-- ANIMATIE STAP 1: Inschuiven
	local tweenIn = TweenService:Create(notifyFrame, slideInInfo, {
		Position = UDim2.new(0.8, 0, 0.8, 0)
	})
	
	tweenIn:Play()
	
	-- Geluidseffect (Optioneel, voeg ID toe indien je een sound hebt)
	-- local sound = Instance.new("Sound", player.PlayerGui)
	-- sound.SoundId = "rbxassetid://..."
	-- sound:Play()

	task.wait(1.8) -- Tijd dat de melding zichtbaar blijft

	-- ANIMATIE STAP 2: Omhoog vliegen en vervagen
	local tweenOut = TweenService:Create(notifyFrame, slideOutInfo, {
		Position = UDim2.new(0.8, 0, 0.7, 0),
		BackgroundTransparency = 1
	})
	
	-- Tekst en Icoon apart vervagen voor maximale smoothness
	local text = notifyFrame:FindFirstChild("AmountText")
	local icon = notifyFrame:FindFirstChild("WoodIcon")
	
	if text then
		TweenService:Create(text, slideOutInfo, {TextTransparency = 1}):Play()
		if text:FindFirstChildWhichIsA("UIStroke") then
			TweenService:Create(text.UIStroke, slideOutInfo, {Transparency = 1}):Play()
		end
	end
	
	if icon then
		TweenService:Create(icon, slideOutInfo, {ImageTransparency = 1}):Play()
	end

	tweenOut:Play()
	
	-- Opruimen
	Debris:AddItem(notifyFrame, 1)
end

--------------------------------------------------------------------------------
-- MAIN UPDATE LOGICA
--------------------------------------------------------------------------------

local function UpdateStatDisplay()
	local woodGui = screenGui:FindFirstChild("WoodGUI")
	local cashGui = screenGui:FindFirstChild("CashGUI")

	if woodGui and woodValue then
		local label = woodGui:FindFirstChildWhichIsA("TextLabel") or woodGui
		label.Text = tostring(woodValue.Value)
	end
	
	if cashGui and leaderstats:FindFirstChild("Cash") then
		local label = cashGui:FindFirstChildWhichIsA("TextLabel") or cashGui
		label.Text = tostring(leaderstats.Cash.Value)
	end
end

--------------------------------------------------------------------------------
-- EVENT LISTENERS
--------------------------------------------------------------------------------

if woodValue then
	woodValue.Changed:Connect(function(newVal)
		UpdateStatDisplay()
		
		local diff = newVal - lastWoodAmount
		if diff > 0 then
			-- Start de geavanceerde animatie
			task.spawn(function()
				PlayNotification(diff)
			end)
		end
		
		lastWoodAmount = newVal
	end)
end

if leaderstats:FindFirstChild("Cash") then
	leaderstats.Cash.Changed:Connect(UpdateStatDisplay)
end

-- Eerste update bij laden
UpdateStatDisplay()

--------------------------------------------------------------------------------
-- STAFF WELKOM LOGICA (Debug console)
--------------------------------------------------------------------------------

print("========================================")
print("Systeem geladen voor: " .. player.Name)
print("Rank: " .. myRank)
if myRank ~= "Speler" then
	print("Welkom, stafflid! UI-Modificaties toegepast.")
end
print("========================================")
